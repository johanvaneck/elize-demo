"use strict";(globalThis["webpackChunkelize_demo"]=globalThis["webpackChunkelize_demo"]||[]).push([[156],{156:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var n=a(252),o=a(262),l=a(693),d=a(577);const i=(0,n._)("h1",null," Click to upload ",-1),c=(0,n._)("h1",null," Feedback ",-1);function r(e,t,a,o,l,r){const s=(0,n.up)("ion-text"),u=(0,n.up)("ion-button");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[i])),_:1}),(0,n.Wm)(u,{onClick:e.onButtonClick},{default:(0,n.w5)((()=>[(0,n.Uk)("Upload Video")])),_:1},8,["onClick"]),(0,n._)("input",{id:"video-input",style:{display:"none"},name:"video-upload",type:"file",onChange:t[0]||(t[0]=t=>e.onChange(t))},null,32),(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[c,(0,n._)("pre",null,"        "+(0,d.zw)(e.feedback)+"\n      ",1)])),_:1})])}var s=a(108),u=a(750);const f=(0,n.aZ)({components:{IonButton:l.YG},data(){return{feedback:""}},methods:{async onChange(e){var t;const a=null===(t=e.target)||void 0===t?void 0:t.files[0];if(a)try{const{data:{user:t}}=await s.Z.auth.getUser(),{data:a,error:n}=await s.Z.from("parent").select().eq("email",null===t||void 0===t?void 0:t.email);this.feedback+=n?"\nparentError: "+n.message:"",this.feedback+=a?"\nparentSuccess: "+a:"";const o=a?a[0].id:"",{data:l,error:d}=await s.Z.from("child").select().eq("parent_id",o);this.feedback+=d?"\nchildError: "+d.message:"",this.feedback+=l?"\nchildSuccess: "+l:"";const i=l?l[0].id:"",c=`public/video-${(0,u.Vj)()}.mp4`,r=e.target.files[0],{data:f,error:p}=await s.Z.storage.from("videos").upload(c,r,{cacheControl:"3600",upsert:!1});this.feedback+=p?"\nbucketError: "+p.message:"",this.feedback+=f?"\nbucketSuccess: "+f:"";const{error:m}=await s.Z.from("video").insert({child_id:i,date_recorded:new Date,bucket_path:c});this.feedback+=m?"\nvideoError: "+m.message:"",this.feedback+=m?"":`\nvideoSuccess: ${c} added to table.`}catch(n){console.log(n)}else console.log("No file provided or found.")},onButtonClick(){const e=document.getElementById("video-input");null===e||void 0===e||e.click()}}});var p=a(744);const m=(0,p.Z)(f,[["render",r]]),h=m,k=(0,n.aZ)({__name:"UploadTab",setup(e){return(0,n.aZ)({components:{}}),(e,t)=>((0,n.wg)(),(0,n.j4)((0,o.SU)(l._i),null,{default:(0,n.w5)((()=>[(0,n.Wm)((0,o.SU)(l.Gu),null,{default:(0,n.w5)((()=>[(0,n.Wm)((0,o.SU)(l.sr),null,{default:(0,n.w5)((()=>[(0,n.Wm)((0,o.SU)(l.wd),null,{default:(0,n.w5)((()=>[(0,n.Uk)("Upload")])),_:1})])),_:1})])),_:1}),(0,n.Wm)((0,o.SU)(l.W2),{class:"ion-padding ion-text-center",fullscreen:!0},{default:(0,n.w5)((()=>[(0,n.Wm)(h)])),_:1})])),_:1}))}}),b=k,_=b}}]);
//# sourceMappingURL=156.530e19ef.js.map