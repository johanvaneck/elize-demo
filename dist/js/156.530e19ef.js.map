{"version":3,"file":"js/156.530e19ef.js","mappings":"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","sources":["webpack://elize-demo/./src/components/VideoUploadButton.vue?5a4a","webpack://elize-demo/./src/components/VideoUploadButton.vue?017b","webpack://elize-demo/./src/components/VideoUploadButton.vue","webpack://elize-demo/./src/views/UploadTab.vue?45b5","webpack://elize-demo/./src/views/UploadTab.vue"],"sourcesContent":["import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"h1\", null, \" Click to upload \", -1)\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"h1\", null, \" Feedback \", -1)\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_ion_text = _resolveComponent(\"ion-text\")!\n  const _component_ion_button = _resolveComponent(\"ion-button\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", null, [\n    _createVNode(_component_ion_text, null, {\n      default: _withCtx(() => [\n        _hoisted_1\n      ]),\n      _: 1\n    }),\n    _createVNode(_component_ion_button, { onClick: _ctx.onButtonClick }, {\n      default: _withCtx(() => [\n        _createTextVNode(\"Upload Video\")\n      ]),\n      _: 1\n    }, 8, [\"onClick\"]),\n    _createElementVNode(\"input\", {\n      id: \"video-input\",\n      style: {\"display\":\"none\"},\n      name: \"video-upload\",\n      type: \"file\",\n      onChange: _cache[0] || (_cache[0] = ($event: any) => (_ctx.onChange($event)))\n    }, null, 32),\n    _createVNode(_component_ion_text, null, {\n      default: _withCtx(() => [\n        _hoisted_2,\n        _createElementVNode(\"pre\", null, \"        \" + _toDisplayString(_ctx.feedback) + \"\\n      \", 1)\n      ]),\n      _: 1\n    })\n  ]))\n}","\nimport supabase from \"@/supabase\";\nimport { IonButton } from \"@ionic/vue\";\nimport { uuid } from \"@supabase/gotrue-js/dist/module/lib/helpers\";\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  components: {\n    IonButton,\n  },\n  data() {\n    return { feedback: \"\" };\n  },\n  methods: {\n    async onChange(event: any) {\n      const file = event.target?.files[0];\n      if (!file) {\n        console.log(\"No file provided or found.\");\n        return;\n      }\n\n      try {\n        //// Get required data first\n        // Get parent data\n        const {\n          data: { user }\n        } = await supabase.auth.getUser()\n        const { data: parentData, error: parentError } = await supabase\n          .from(\"parent\")\n          .select()\n          .eq(\"email\", user?.email);\n\n        this.feedback += (parentError ? \"\\nparentError: \" + parentError.message : \"\")\n        this.feedback += (parentData ? \"\\nparentSuccess: \" + parentData : \"\")\n\n        const parentId = parentData ? parentData[0].id : \"\";\n\n        // Get child data\n        const { data: childData, error: childError } = await supabase\n          .from(\"child\")\n          .select()\n          .eq(\"parent_id\", parentId);\n\n        this.feedback += (childError ? \"\\nchildError: \" + childError.message : \"\")\n        this.feedback += (childData ? \"\\nchildSuccess: \" + childData : \"\")\n\n        const childId = childData ? childData[0].id : \"\";\n\n        // Upload to Supabase\n        const bucketPath = `public/video-${uuid()}.mp4`;\n        const videoFile = event.target.files[0];\n        const { data: bucketData, error: bucketError } = await supabase.storage\n          .from(\"videos\")\n          .upload(bucketPath, videoFile, {\n            cacheControl: \"3600\",\n            upsert: false,\n          });\n        this.feedback += (bucketError ? \"\\nbucketError: \" + bucketError.message : \"\")\n        this.feedback += (bucketData ? \"\\nbucketSuccess: \" + bucketData : \"\")\n\n        // Insert video data\n        const { error: videoError } = await supabase.from(\"video\").insert({\n          child_id: childId,\n          date_recorded: new Date(),\n          bucket_path: bucketPath,\n        });\n\n        this.feedback += (videoError ? \"\\nvideoError: \" + videoError.message : \"\")\n        this.feedback += (!videoError ? \"\\nvideoSuccess: \" + `${bucketPath} added to table.` : \"\")\n      } catch (e) {\n        console.log(e)\n      }\n    },\n    onButtonClick() {\n      const videoInput = document.getElementById(\"video-input\");\n      videoInput?.click();\n    },\n  },\n});\n","import { render } from \"./VideoUploadButton.vue?vue&type=template&id=11f6c703&ts=true\"\nimport script from \"./VideoUploadButton.vue?vue&type=script&lang=ts\"\nexport * from \"./VideoUploadButton.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, unref as _unref, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport {\n  IonPage,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n} from \"@ionic/vue\";\nimport { defineComponent } from \"vue\";\nimport VideoUploadButton from \"@/components/VideoUploadButton.vue\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'UploadTab',\n  setup(__props) {\n\ndefineComponent({\n  components: {},\n});\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(_unref(IonPage), null, {\n    default: _withCtx(() => [\n      _createVNode(_unref(IonHeader), null, {\n        default: _withCtx(() => [\n          _createVNode(_unref(IonToolbar), null, {\n            default: _withCtx(() => [\n              _createVNode(_unref(IonTitle), null, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"Upload\")\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(_unref(IonContent), {\n        class: \"ion-padding ion-text-center\",\n        fullscreen: true\n      }, {\n        default: _withCtx(() => [\n          _createVNode(VideoUploadButton)\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","import script from \"./UploadTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./UploadTab.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","_createElementVNode","_hoisted_2","render","_ctx","_cache","$props","$setup","$data","$options","_component_ion_text","_resolveComponent","_component_ion_button","_openBlock","_createElementBlock","_createVNode","default","_withCtx","_","onClick","onButtonClick","_createTextVNode","id","style","name","type","onChange","$event","_toDisplayString","feedback","defineComponent","components","IonButton","data","methods","async","event","_event$target","file","target","files","user","supabase","parentData","error","parentError","select","eq","email","this","message","parentId","childData","childError","childId","bucketPath","uuid","videoFile","bucketData","bucketError","upload","cacheControl","upsert","videoError","insert","child_id","date_recorded","Date","bucket_path","e","console","log","videoInput","document","getElementById","click","__exports__","_defineComponent","__name","setup","__props","_createBlock","_unref","IonPage","IonHeader","IonToolbar","IonTitle","IonContent","class","fullscreen","VideoUploadButton"],"sourceRoot":""}