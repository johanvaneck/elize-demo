{"version":3,"file":"js/878.c1a93db3.js","mappings":"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","sources":["webpack://elize-demo/./src/components/VideoUploadButton.vue?0f75","webpack://elize-demo/./src/components/VideoUploadButton.vue?017b","webpack://elize-demo/./src/components/VideoUploadButton.vue","webpack://elize-demo/./src/views/VideoUploadTab.vue?aff2","webpack://elize-demo/./src/views/VideoUploadTab.vue"],"sourcesContent":["import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"h1\", null, \" Click to upload your video \", -1)\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_ion_text = _resolveComponent(\"ion-text\")!\n  const _component_ion_button = _resolveComponent(\"ion-button\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(_component_ion_text, null, {\n      default: _withCtx(() => [\n        _hoisted_1\n      ]),\n      _: 1\n    }),\n    _createVNode(_component_ion_button, { onClick: _ctx.onButtonClick }, {\n      default: _withCtx(() => [\n        _createTextVNode(\"Upload Video\")\n      ]),\n      _: 1\n    }, 8, [\"onClick\"]),\n    _createElementVNode(\"input\", {\n      id: \"video-input\",\n      style: {\"display\":\"none\"},\n      name: \"video-upload\",\n      type: \"file\",\n      onChange: _cache[0] || (_cache[0] = ($event: any) => (_ctx.onChange($event)))\n    }, null, 32)\n  ], 64))\n}","\nimport supabase from \"@/supabase\";\nimport { IonButton, toastController } from \"@ionic/vue\";\nimport { uuid } from \"@supabase/gotrue-js/dist/module/lib/helpers\";\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  components: {\n    IonButton,\n  },\n  data() {\n    return {};\n  },\n  methods: {\n    async onChange(event: any) {\n      let feedback = \"\"\n      const file = event.target?.files[0];\n      if (!file) {\n        console.log(\"No file provided or found.\");\n        return;\n      }\n\n      try {\n        //// Get required data first\n        // Get parent data\n        const {\n          data: { session }\n        } = await supabase.auth.getSession()\n        const { data: parentData, error: parentError } = await supabase\n          .from(\"parent\")\n          .select()\n          .eq(\"email\", session?.user.email);\n\n        feedback += (parentError ? \"\\nparentError: \" + parentError.message : \"\")\n\n        const parentId = parentData ? parentData[0].id : \"\";\n\n        // Get child data\n        const { data: childData, error: childError } = await supabase\n          .from(\"child\")\n          .select()\n          .eq(\"parent_id\", parentId);\n\n        feedback += (childError ? \"\\nchildError: \" + childError.message : \"\")\n\n        const childId = childData ? childData[0].id : \"\";\n\n        // Upload to Supabase\n        const bucketPath = `public/video-${uuid()}.mp4`;\n        const videoFile = event.target.files[0];\n        const { error: bucketError } = await supabase.storage\n          .from(\"videos\")\n          .upload(bucketPath, videoFile, {\n            cacheControl: \"3600\",\n            upsert: false,\n          });\n        feedback += (bucketError ? \"\\nbucketError: \" + bucketError.message : \"\")\n\n        // Insert video data\n        const { error: videoError } = await supabase.from(\"video\").insert({\n          child_id: childId,\n          date_recorded: new Date(),\n          bucket_path: bucketPath,\n        });\n\n        feedback += (videoError ? \"\\nvideoError: \" + videoError.message : \"\")\n\n        const message = feedback === \"\" ? \"Successfully uploaded video.\" : feedback\n        const toast = await toastController.create({\n          message,\n          duration: 2000,\n        });\n        toast.present();\n\n      } catch (e) {\n        const toast = await toastController.create({\n          message: feedback,\n          duration: 2000,\n        });\n        toast.present();\n      }\n    },\n    onButtonClick() {\n      const videoInput = document.getElementById(\"video-input\");\n      videoInput?.click();\n    },\n  },\n});\n","import { render } from \"./VideoUploadButton.vue?vue&type=template&id=4dbed432&ts=true\"\nimport script from \"./VideoUploadButton.vue?vue&type=script&lang=ts\"\nexport * from \"./VideoUploadButton.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, unref as _unref, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport {\n  IonPage,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n} from \"@ionic/vue\";\nimport { defineComponent } from \"vue\";\nimport VideoUploadButton from \"@/components/VideoUploadButton.vue\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'VideoUploadTab',\n  setup(__props) {\n\ndefineComponent({\n  components: {},\n});\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(_unref(IonPage), null, {\n    default: _withCtx(() => [\n      _createVNode(_unref(IonHeader), null, {\n        default: _withCtx(() => [\n          _createVNode(_unref(IonToolbar), null, {\n            default: _withCtx(() => [\n              _createVNode(_unref(IonTitle), null, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"Upload\")\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(_unref(IonContent), {\n        class: \"ion-padding ion-text-center\",\n        fullscreen: true\n      }, {\n        default: _withCtx(() => [\n          _createVNode(VideoUploadButton)\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","import script from \"./VideoUploadTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./VideoUploadTab.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","_createElementVNode","render","_ctx","_cache","$props","$setup","$data","$options","_component_ion_text","_resolveComponent","_component_ion_button","_openBlock","_createElementBlock","_Fragment","_createVNode","default","_withCtx","_","onClick","onButtonClick","_createTextVNode","id","style","name","type","onChange","$event","defineComponent","components","IonButton","data","methods","async","event","_event$target","feedback","file","target","files","session","supabase","parentData","error","parentError","select","eq","user","email","message","parentId","childData","childError","childId","bucketPath","uuid","videoFile","bucketError","upload","cacheControl","upsert","videoError","insert","child_id","date_recorded","Date","bucket_path","toast","toastController","duration","present","e","console","log","videoInput","document","getElementById","click","__exports__","_defineComponent","__name","setup","__props","_createBlock","_unref","IonPage","IonHeader","IonToolbar","IonTitle","IonContent","class","fullscreen","VideoUploadButton"],"sourceRoot":""}